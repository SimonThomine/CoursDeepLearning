
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>äºŒå…ƒæ¨¡å‹ï¼ˆBigramï¼‰ &#8212; Deep Learning Course</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '05_NLP/02_bigramme';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="å…¨è¿æ¥ç¥ç»ç½‘ç»œ" href="03_R%C3%A9seauFullyConnected.html" />
    <link rel="prev" title="è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰ç®€ä»‹" href="01_Introduction.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content"><span style="font-size:2em; font-weight:bold;">ğŸš€ ä»é›¶å¼€å§‹å­¦ä¹ æ·±åº¦å­¦ä¹  ğŸš€</span></div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../README.html">
  
  
  
  
  
  
    <p class="title logo__title">Deep Learning Course</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    æ·±åº¦å­¦ä¹ è¯¾ç¨‹ ğŸš€
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">ğŸ§® åŸºç¡€</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../01_Fondations/01_D%C3%A9riv%C3%A9esEtDescenteDuGradient.html">å¯¼æ•°ä¸æ¢¯åº¦ä¸‹é™</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01_Fondations/02_R%C3%A9gressionLogistique.html">é€»è¾‘å›å½’</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ğŸ”— å…¨è¿æ¥ç½‘ç»œ</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../02_R%C3%A9seauFullyConnected/01_MonPremierR%C3%A9seau.html">æˆ‘çš„ç¬¬ä¸€ä¸ªç¥ç»ç½‘ç»œ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_R%C3%A9seauFullyConnected/02_PytorchIntroduction.html">PyTorch ç®€ä»‹</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_R%C3%A9seauFullyConnected/03_TechniquesAvanc%C3%A9es.html">é«˜çº§æŠ€æœ¯</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ğŸ–¼ï¸ å·ç§¯ç½‘ç»œ</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../03_R%C3%A9seauConvolutifs/01_CouchesDeConvolutions.html">å·ç§¯å±‚</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_R%C3%A9seauConvolutifs/02_R%C3%A9seauConvolutif.html">å·ç§¯ç¥ç»ç½‘ç»œ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_R%C3%A9seauConvolutifs/03_ConvImplementation.html">å·ç§¯å±‚çš„å®ç°</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_R%C3%A9seauConvolutifs/04_R%C3%A9seauConvolutifPytorch.html">ä½¿ç”¨ PyTorch æ„å»ºå·ç§¯ç¥ç»ç½‘ç»œ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_R%C3%A9seauConvolutifs/05_ApplicationClassification.html">åœ¨å½©è‰²å›¾åƒæ•°æ®é›†ä¸Šçš„åº”ç”¨</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_R%C3%A9seauConvolutifs/06_ApplicationSegmentation.html">å›¾åƒåˆ†å‰²çš„åº”ç”¨</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ğŸ”„ è‡ªç¼–ç å™¨</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../04_Autoencodeurs/01_IntuitionEtPremierAE.html">è‡ªç¼–ç å™¨ç®€ä»‹</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_Autoencodeurs/02_DenoisingAE.html">ä½¿ç”¨è‡ªç¼–ç å™¨è¿›è¡Œå›¾åƒå»å™ª</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ğŸ“ è‡ªç„¶è¯­è¨€å¤„ç† (NLP)</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_Introduction.html">è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰ç®€ä»‹</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">äºŒå…ƒæ¨¡å‹ï¼ˆBigramï¼‰</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_R%C3%A9seauFullyConnected.html">å…¨è¿æ¥ç¥ç»ç½‘ç»œ</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_WaveNet.html">ä½¿ç”¨ PyTorch å®ç° WaveNet</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_Rnn.html">å¾ªç¯ç¥ç»ç½‘ç»œ</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_Lstm.html">é•¿çŸ­æœŸè®°å¿†ç½‘ç»œï¼ˆLSTMï¼‰</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ğŸ¤— HuggingFace</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../06_HuggingFace/01_introduction.html">Hugging Face ç®€ä»‹</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06_HuggingFace/02_ComputerVisionWithTransformers.html">ä½¿ç”¨ Transformer çš„è®¡ç®—æœºè§†è§‰</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06_HuggingFace/03_NlpWithTransformers.html">ä½¿ç”¨ Transformers è¿›è¡Œè‡ªç„¶è¯­è¨€å¤„ç†</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06_HuggingFace/04_AudioWithTransformers.html">ä½¿ç”¨ Transformers å¤„ç†éŸ³é¢‘</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06_HuggingFace/05_ImageGenerationWithDiffusers.html">ä½¿ç”¨ Diffusers ç”Ÿæˆå›¾åƒ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06_HuggingFace/06_DemoAvecGradio.html">ä½¿ç”¨ Gradio è¿›è¡Œæ¼”ç¤º</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">âš¡ Transformers</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../07_Transformers/01_Introduction.html">Transformer æ¨¡å‹ç®€ä»‹</a></li>
<li class="toctree-l1"><a class="reference internal" href="../07_Transformers/02_GptFromScratch.html">ä»é›¶å¼€å§‹æ„å»º GPT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../07_Transformers/03_TrainingOurGpt.html">è®­ç»ƒæˆ‘ä»¬çš„ GPT æ¨¡å‹</a></li>
<li class="toctree-l1"><a class="reference internal" href="../07_Transformers/04_ArchitectureEtParticularit%C3%A9s.html">å˜å‹å™¨çš„ç»“æ„å’Œç‰¹æ€§</a></li>
<li class="toctree-l1"><a class="reference internal" href="../07_Transformers/05_UtilisationsPossibles.html">Transformeræ¶æ„çš„å¯èƒ½åº”ç”¨</a></li>
<li class="toctree-l1"><a class="reference internal" href="../07_Transformers/06_VisionTransformerImplementation.html">Vision Transformer çš„å®ç°</a></li>
<li class="toctree-l1"><a class="reference internal" href="../07_Transformers/07_SwinTransformer.html">Swin Transformer</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ğŸ¯ ç›®æ ‡æ£€æµ‹ (YOLO)</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../08_DetectionEtYolo/01_Introduction.html">å›¾åƒä¸­çš„ç›®æ ‡æ£€æµ‹ç®€ä»‹</a></li>
<li class="toctree-l1"><a class="reference internal" href="../08_DetectionEtYolo/02_YoloEnDetail.html">YOLO è¯¦è§£</a></li>
<li class="toctree-l1"><a class="reference internal" href="../08_DetectionEtYolo/03_Ultralytics.html">Ultralytics</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ğŸ” å¯¹æ¯”å­¦ä¹ è®­ç»ƒ</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../09_EntrainementContrastif/01_FaceVerification.html">äººè„¸éªŒè¯</a></li>
<li class="toctree-l1"><a class="reference internal" href="../09_EntrainementContrastif/02_NonSupervis%C3%A9.html">æ— ç›‘ç£å¯¹æ¯”å­¦ä¹ </a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ğŸ“ è¿ç§»å­¦ä¹ ä¸è’¸é¦</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../10_TransferLearningEtDistillation/01_TransferLearning.html">è¿ç§»å­¦ä¹ </a></li>
<li class="toctree-l1"><a class="reference internal" href="../10_TransferLearningEtDistillation/02_TransferLearningPytorch.html">ä½¿ç”¨ PyTorch è¿›è¡Œè¿ç§»å­¦ä¹ </a></li>
<li class="toctree-l1"><a class="reference internal" href="../10_TransferLearningEtDistillation/03_Distillation.html">çŸ¥è¯†è’¸é¦</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10_TransferLearningEtDistillation/04_DistillationAnomalie.html">æ— ç›‘ç£å¼‚å¸¸æ£€æµ‹çš„çŸ¥è¯†è’¸é¦</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10_TransferLearningEtDistillation/05_FineTuningLLM.html">å¤§å‹è¯­è¨€æ¨¡å‹çš„å¾®è°ƒ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10_TransferLearningEtDistillation/06_FineTuningBertHF.html">ä½¿ç”¨ Hugging Face å¯¹ BERT è¿›è¡Œå¾®è°ƒ</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ğŸ¨ ç”Ÿæˆæ¨¡å‹</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../11_ModelesGeneratifs/01_Introduction.html">ç”Ÿæˆæ¨¡å‹ç®€ä»‹</a></li>
<li class="toctree-l1"><a class="reference internal" href="../11_ModelesGeneratifs/02_GAN.html">ç”Ÿæˆå¯¹æŠ—ç½‘ç»œï¼ˆGANï¼‰</a></li>
<li class="toctree-l1"><a class="reference internal" href="../11_ModelesGeneratifs/03_GanImplementation.html">ç”Ÿæˆå¯¹æŠ—ç½‘ç»œï¼ˆGANï¼‰çš„å®ç°</a></li>
<li class="toctree-l1"><a class="reference internal" href="../11_ModelesGeneratifs/04_VAE.html">å˜åˆ†è‡ªç¼–ç å™¨</a></li>
<li class="toctree-l1"><a class="reference internal" href="../11_ModelesGeneratifs/05_VaeImplementation.html">å˜åˆ†è‡ªç¼–ç å™¨ï¼ˆVAEï¼‰çš„å®ç°</a></li>
<li class="toctree-l1"><a class="reference internal" href="../11_ModelesGeneratifs/06_NormalizingFlows.html">å½’ä¸€åŒ–æµ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../11_ModelesGeneratifs/07_DiffusionModels.html">æ‰©æ•£æ¨¡å‹</a></li>
<li class="toctree-l1"><a class="reference internal" href="../11_ModelesGeneratifs/08_DiffusionImplementation.html">æ‰©æ•£æ¨¡å‹çš„å®ç°</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">ğŸ æ‹“å±•ä¸“é¢˜</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Bonus_CoursSp%C3%A9cifiques/01_ActivationEtInitialisation.html">æ¿€æ´»å‡½æ•°ä¸åˆå§‹åŒ–</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Bonus_CoursSp%C3%A9cifiques/02_BatchNorm.html">æ‰¹é‡å½’ä¸€åŒ–</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Bonus_CoursSp%C3%A9cifiques/03_DataAugmentation.html">æ•°æ®å¢å¼º</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Bonus_CoursSp%C3%A9cifiques/04_Broadcasting.html">å¹¿æ’­æœºåˆ¶</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Bonus_CoursSp%C3%A9cifiques/05_Optimizer.html">ç†è§£ä¸åŒçš„ä¼˜åŒ–å™¨</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Bonus_CoursSp%C3%A9cifiques/06_Regularisation.html">æ­£åˆ™åŒ–</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Bonus_CoursSp%C3%A9cifiques/07_ConnexionsResiduelles.html">æ®‹å·®è¿æ¥</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Bonus_CoursSp%C3%A9cifiques/08_CrossValidation.html">äº¤å‰éªŒè¯ç®€ä»‹</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Bonus_CoursSp%C3%A9cifiques/09_MetriquesEvaluation.html">æ¨¡å‹è¯„ä¼°æŒ‡æ ‡</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Bonus_CoursSp%C3%A9cifiques/10_Tokenization.html">è¯å…ƒåŒ–ä»‹ç»</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Bonus_CoursSp%C3%A9cifiques/11_Quantization.html">æ¨¡å‹é‡åŒ–</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/SimonThomine/CoursDeepLearning" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/SimonThomine/CoursDeepLearning/edit/main/en/05_NLP/02_bigramme.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/SimonThomine/CoursDeepLearning/issues/new?title=Issue%20on%20page%20%2F05_NLP/02_bigramme.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/05_NLP/02_bigramme.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>äºŒå…ƒæ¨¡å‹ï¼ˆBigramï¼‰</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">æ•°æ®é›†åˆ†æ</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">ä»€ä¹ˆæ˜¯äºŒå…ƒæ¨¡å‹ï¼Ÿ</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">è®¡æ•°æ–¹æ³•</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">å‡ºç°é¢‘æ¬¡çŸ©é˜µ</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">æ¦‚ç‡</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">ç”Ÿæˆ</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">æ¨¡å‹è¯„ä¼°</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#likelihood">æœ€å¤§ä¼¼ç„¶ï¼ˆLikelihoodï¼‰</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#log-likelihood">å¯¹æ•°ä¼¼ç„¶ï¼ˆLog-likelihoodï¼‰</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">ç¥ç»ç½‘ç»œæ–¹æ³•</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">è®¡æ•°æ–¹æ³•çš„é—®é¢˜</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">ç¥ç»ç½‘ç»œçš„æ•°æ®é›†</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">æˆ‘ä»¬çš„ç¥ç»ç½‘ç»œ</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">ä¼˜åŒ–</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">è¡¥å……è¯´æ˜</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="bigram">
<h1>äºŒå…ƒæ¨¡å‹ï¼ˆBigramï¼‰<a class="headerlink" href="#bigram" title="Link to this heading">#</a></h1>
<section id="id1">
<h2>æ•°æ®é›†åˆ†æ<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">words</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;prenoms.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Les 5 prÃ©noms les plus populaires : &#39;</span><span class="p">,</span><span class="n">words</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Les 5 prÃ©noms les moins populaires : &#39;</span><span class="p">,</span><span class="n">words</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Le prÃ©nom le plus long : &#39;</span><span class="p">,</span><span class="nb">max</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">len</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Le prÃ©nom le plus court : &#39;</span><span class="p">,</span><span class="nb">min</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">len</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Les 5 prÃ©noms les plus populaires :  [&#39;MARIE&#39;, &#39;JEAN&#39;, &#39;PIERRE&#39;, &#39;MICHEL&#39;, &#39;ANDRÃ‰&#39;]
Les 5 prÃ©noms les moins populaires :  [&#39;Ã‰LOUEN&#39;, &#39;CHEYNA&#39;, &#39;BLONDIE&#39;, &#39;IMANN&#39;, &#39;GHILAIN&#39;]
Le prÃ©nom le plus long :  GUILLAUME-ALEXANDRE
Le prÃ©nom le plus court :  GUY
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unique_characters</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
  <span class="c1"># Ajouter chaque caractÃ¨re de la ligne Ã  l&#39;ensemble des caractÃ¨res uniques</span>
  <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">word</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
    <span class="n">unique_characters</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Nombre de caractÃ¨res uniques : &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_characters</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CaractÃ¨res uniques : &#39;</span><span class="p">,</span><span class="n">unique_characters</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Nombre de caractÃ¨res uniques :  45
CaractÃ¨res uniques :  {&#39;Ã&#39;, &#39;Ãœ&#39;, &#39;Å¸&#39;, &#39;U&#39;, &#39;Ã”&#39;, &#39;S&#39;, &#39;Ã†&#39;, &#39;Ã€&#39;, &#39;Ãˆ&#39;, &#39;-&#39;, &#39;W&#39;, &#39;H&#39;, &#39;ÃŠ&#39;, &#39;Ã‰&#39;, &#39;R&#39;, &#39;M&#39;, &#39;E&#39;, &#39;Ã‹&#39;, &#39;N&#39;, &#39;Ã&#39;, &#39;X&#39;, &#39;Ã„&#39;, &#39;F&#39;, &#39;Ã‚&#39;, &#39;K&#39;, &#39;D&#39;, &#39;Ã–&#39;, &#39;I&#39;, &#39;J&#39;, &#39;Y&#39;, &#39;A&#39;, &#39;C&#39;, &#39;O&#39;, &#39;Ã›&#39;, &#39;Ã™&#39;, &#39;B&#39;, &#39;Z&#39;, &#39;P&#39;, &#39;T&#39;, &quot;&#39;&quot;, &#39;Q&#39;, &#39;Ã‡&#39;, &#39;G&#39;, &#39;L&#39;, &#39;V&#39;}
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h2>ä»€ä¹ˆæ˜¯äºŒå…ƒæ¨¡å‹ï¼Ÿ<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<p>å›é¡¾ä¸€ä¸‹ï¼Œæœ¬é¡¹ç›®çš„ç›®æ ‡æ˜¯åŸºäºå‰é¢çš„å­—ç¬¦é¢„æµ‹ä¸‹ä¸€ä¸ªå­—ç¬¦ã€‚åœ¨<strong>äºŒå…ƒæ¨¡å‹</strong>ä¸­ï¼Œæˆ‘ä»¬ä»…æ ¹æ®å‰ä¸€ä¸ªå­—ç¬¦æ¥é¢„æµ‹å½“å‰å­—ç¬¦ã€‚è¿™æ˜¯æ­¤ç±»æ¨¡å‹ä¸­æœ€ç®€å•çš„ç‰ˆæœ¬ã€‚</p>
<p>å½“ç„¶ï¼Œè¦é¢„æµ‹ä¸€ä¸ªåå­—ï¼Œæˆ‘ä»¬éœ€è¦ä»é›¶å¼€å§‹ã€‚ä¸ºäº†é¢„æµ‹ç¬¬ä¸€ä¸ªå­—æ¯ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“æŸä¸ªå­—æ¯ä½œä¸ºç¬¬ä¸€ä¸ªå­—æ¯çš„æ¦‚ç‡ï¼ˆæœ€åä¸€ä¸ªå­—æ¯åŒç†ï¼‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨æ„å»ºäºŒå…ƒæ¨¡å‹ä¹‹å‰ï¼Œä¼šåœ¨æ¯ä¸ªå•è¯çš„å¼€å¤´å’Œç»“å°¾æ·»åŠ ä¸€ä¸ªç‰¹æ®Šå­—ç¬¦â€œ.â€ã€‚</p>
<p>åœ¨æ¯ä¸ªåå­—ä¸­ï¼Œæˆ‘ä»¬æœ‰å¤šä¸ªäºŒå…ƒæ¨¡å‹çš„ä¾‹å­ï¼ˆæ¯ä¸ªä¾‹å­éƒ½æ˜¯ç‹¬ç«‹çš„ï¼‰ã€‚
æˆ‘ä»¬ä»¥ç¬¬ä¸€ä¸ªåå­—ä¸ºä¾‹ï¼Œçœ‹çœ‹å®ƒåŒ…å«å¤šå°‘ä¸ªäºŒå…ƒæ¨¡å‹ï¼š</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">ch1</span><span class="p">,</span> <span class="n">ch2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">chs</span><span class="p">,</span> <span class="n">chs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
  <span class="n">bigram</span> <span class="o">=</span> <span class="p">(</span><span class="n">ch1</span><span class="p">,</span> <span class="n">ch2</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">bigram</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;.&#39;, &#39;M&#39;)
(&#39;M&#39;, &#39;A&#39;)
(&#39;A&#39;, &#39;R&#39;)
(&#39;R&#39;, &#39;I&#39;)
(&#39;I&#39;, &#39;E&#39;)
(&#39;E&#39;, &#39;.&#39;)
</pre></div>
</div>
</div>
</div>
<p>åå­—â€œMarieâ€åŒ…å«6ä¸ªäºŒå…ƒæ¨¡å‹ã€‚</p>
</section>
<section id="id3">
<h2>è®¡æ•°æ–¹æ³•<a class="headerlink" href="#id3" title="Link to this heading">#</a></h2>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬æ„å»ºä¸€ä¸ª Python å­—å…¸ï¼Œå°†æ•°æ®é›†ä¸­æ‰€æœ‰äºŒå…ƒæ¨¡å‹çš„å‡ºç°æ¬¡æ•°æ±‡æ€»èµ·æ¥ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
  <span class="n">chs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span>
  <span class="k">for</span> <span class="n">ch1</span><span class="p">,</span> <span class="n">ch2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">chs</span><span class="p">,</span> <span class="n">chs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="n">bigram</span> <span class="o">=</span> <span class="p">(</span><span class="n">ch1</span><span class="p">,</span> <span class="n">ch2</span><span class="p">)</span>
    <span class="n">b</span><span class="p">[</span><span class="n">bigram</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">bigram</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<span class="nb">sorted</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">kv</span><span class="p">:</span> <span class="o">-</span><span class="n">kv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Les 5 bigrammes les plus frÃ©quents : &#39;</span><span class="p">,</span><span class="nb">sorted</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">kv</span><span class="p">:</span> <span class="o">-</span><span class="n">kv</span><span class="p">[</span><span class="mi">1</span><span class="p">])[:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Les 5 bigrammes les plus frÃ©quents :  [((&#39;A&#39;, &#39;.&#39;), 7537), ((&#39;E&#39;, &#39;.&#39;), 6840), ((&#39;A&#39;, &#39;N&#39;), 6292), ((&#39;N&#39;, &#39;.&#39;), 3741), ((&#39;N&#39;, &#39;E&#39;), 3741)]
</pre></div>
</div>
</div>
</div>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬å¾—åˆ°äº†æ•´ä¸ªæ•°æ®é›†ä¸­äºŒå…ƒæ¨¡å‹çš„é¢‘ç‡å­—å…¸ã€‚å¯ä»¥çœ‹åˆ°ï¼Œåå­—å¸¸ä»¥ Aã€E æˆ– N ç»“å°¾ï¼Œä¸”å­—æ¯ A å’Œ N ç»å¸¸è¿ç»­å‡ºç°ï¼ŒN å’Œ E ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p>
<section id="id4">
<h3>å‡ºç°é¢‘æ¬¡çŸ©é˜µ<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>ä»¥çŸ©é˜µå½¢å¼å¯è§†åŒ–å’Œå¤„ç†æ•°æ®ä¼šæ›´ç®€ä¾¿ã€‚æˆ‘ä»¬å°†æ„å»ºä¸€ä¸ª 46Ã—46 çš„çŸ©é˜µï¼ˆ45ä¸ªå­—ç¬¦ + 1ä¸ªç‰¹æ®Šå­—ç¬¦â€œ.â€ï¼‰ï¼Œå…¶ä¸­è¡Œå¯¹åº”ç¬¬ä¸€ä¸ªå­—æ¯ï¼Œåˆ—å¯¹åº”ç¬¬äºŒä¸ªå­—æ¯ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">46</span><span class="p">,</span> <span class="mi">46</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>æˆ‘ä»¬å°†å¯¹å­—ç¬¦è¿›è¡Œæ’åºï¼Œå¹¶ä½¿ç”¨ Python å­—å…¸åˆ›å»ºæŸ¥æ‰¾è¡¨ï¼ˆlook-up tablesï¼‰ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸€ä¸ªå­—ç¬¦è½¬æ¢ä¸ºæ•´æ•°ï¼ˆç”¨äºçŸ©é˜µç´¢å¼•ï¼‰ï¼Œåä¹‹äº¦ç„¶ï¼ˆä»æ•´æ•°é‡æ„åå­—ï¼‰ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chars</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">words</span><span class="p">))))</span>
<span class="n">stoi</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">chars</span><span class="p">)}</span>
<span class="n">stoi</span><span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">itos</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span><span class="p">,</span><span class="n">i</span> <span class="ow">in</span> <span class="n">stoi</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</pre></div>
</div>
</div>
</div>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬å°†å¡«å……çŸ©é˜µï¼š</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
  <span class="n">chs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span>
  <span class="k">for</span> <span class="n">ch1</span><span class="p">,</span> <span class="n">ch2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">chs</span><span class="p">,</span> <span class="n">chs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="n">ix1</span> <span class="o">=</span> <span class="n">stoi</span><span class="p">[</span><span class="n">ch1</span><span class="p">]</span>
    <span class="n">ix2</span> <span class="o">=</span> <span class="n">stoi</span><span class="p">[</span><span class="n">ch2</span><span class="p">]</span>
    <span class="n">N</span><span class="p">[</span><span class="n">ix1</span><span class="p">,</span> <span class="n">ix2</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥æ˜¾ç¤ºè¿™ä¸ªçŸ©é˜µï¼ˆæŸ¥æ‰¾è¡¨ï¼‰äº†ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Code pour dessiner une jolie matrice</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span><span class="mi">32</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">46</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">46</span><span class="p">):</span>
    <span class="n">chstr</span> <span class="o">=</span> <span class="n">itos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">itos</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">chstr</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">N</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/96ce12bf8300ffce2957c0bdc85dadbf28244c9c48c5c995ed2a013ee17708cf.png" src="../_images/96ce12bf8300ffce2957c0bdc85dadbf28244c9c48c5c995ed2a013ee17708cf.png" />
</div>
</div>
</section>
<section id="id5">
<h3>æ¦‚ç‡<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<p>è¦è®¡ç®—åå­—ä»¥æŸä¸ªå­—æ¯å¼€å¤´çš„æ¦‚ç‡ï¼Œæˆ‘ä»¬éœ€è¦æŸ¥çœ‹ç‰¹æ®Šå­—ç¬¦â€œ.â€æ‰€åœ¨çš„è¡Œï¼ˆå³ç¬¬0è¡Œï¼‰ï¼Œå¹¶å°†è¯¥è¡Œçš„æ¯ä¸ªå€¼é™¤ä»¥è¯¥è¡Œæ‰€æœ‰å€¼çš„æ€»å’Œï¼ˆä»¥å¾—åˆ°0åˆ°1ä¹‹é—´ä¸”æ€»å’Œä¸º1çš„æ¦‚ç‡å€¼ï¼‰ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">N</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">/</span> <span class="n">p</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Compte de la premiÃ¨re ligne : &quot;</span><span class="p">,</span><span class="n">N</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ProbabilitÃ©s : &quot;</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Compte de la premiÃ¨re ligne :  tensor([   0,    0,    0, 3399,  825, 1483, 1208, 1400,  864,  907, 1039,  788,
        1352, 1503, 2108, 3606, 1501,  546,  620,   32, 1142, 2539, 1185,   72,
         329,  294,   29,  661,  393,    0,    2,    0,    0,    1,    2,  161,
           0,    0,    2,    2,    0,    5,    0,    0,    0,    0],
       dtype=torch.int32)
ProbabilitÃ©s :  tensor([0.0000e+00, 0.0000e+00, 0.0000e+00, 1.1330e-01, 2.7500e-02, 4.9433e-02,
        4.0267e-02, 4.6667e-02, 2.8800e-02, 3.0233e-02, 3.4633e-02, 2.6267e-02,
        4.5067e-02, 5.0100e-02, 7.0267e-02, 1.2020e-01, 5.0033e-02, 1.8200e-02,
        2.0667e-02, 1.0667e-03, 3.8067e-02, 8.4633e-02, 3.9500e-02, 2.4000e-03,
        1.0967e-02, 9.8000e-03, 9.6667e-04, 2.2033e-02, 1.3100e-02, 0.0000e+00,
        6.6667e-05, 0.0000e+00, 0.0000e+00, 3.3333e-05, 6.6667e-05, 5.3667e-03,
        0.0000e+00, 0.0000e+00, 6.6667e-05, 6.6667e-05, 0.0000e+00, 1.6667e-04,
        0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00])
</pre></div>
</div>
</div>
</div>
<p>ä¸ºäº†éšæœºç”Ÿæˆåå­—ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›æ€»æ˜¯é€‰æ‹©æ¦‚ç‡æœ€é«˜çš„å­—æ¯ï¼ˆå¦åˆ™æ€»ä¼šç”Ÿæˆç›¸åŒçš„åå­—ï¼‰ã€‚æˆ‘ä»¬å¸Œæœ›æ ¹æ®æ¦‚ç‡é€‰æ‹©å­—æ¯ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå­—æ¯â€œnâ€çš„æ¦‚ç‡ä¸º0.1ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¸Œæœ›å®ƒæœ‰10%çš„æ¦‚ç‡è¢«é€‰ä¸­ã€‚
ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨ PyTorch çš„ <code class="docutils literal notranslate"><span class="pre">torch.multinomial</span></code> å‡½æ•°ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ix</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">multinomial</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">replacement</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<span class="n">itos</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Z&#39;
</pre></div>
</div>
</div>
</div>
<p>æ¯æ¬¡è°ƒç”¨æ—¶ï¼Œæˆ‘ä»¬ä¼šæ ¹æ®å­—æ¯åœ¨æµ‹è¯•æ•°æ®é›†ä¸­çš„å‡ºç°æ¦‚ç‡ï¼Œå¾—åˆ°ä¸åŒçš„å­—æ¯ã€‚</p>
<p>æœ‰äº†è¿™äº›å…ƒç´ ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥ä»çŸ©é˜µ N ç”Ÿæˆåå­—äº†ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åˆ›å»ºä¸€ä¸ªåŒ…å«æ¦‚ç‡çš„çŸ©é˜µï¼Œä»¥é¿å…æ¯æ¬¡éƒ½è¦é‡æ–°å½’ä¸€åŒ–ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># On copie N et on la convertit en float</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
<span class="c1"># On normalise chaque ligne</span>
<span class="c1"># On somme sur la premiÃ¨re dimension (les colonnes)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Somme des lignes : &quot;</span><span class="p">,</span><span class="n">P</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">P</span> <span class="o">/=</span> <span class="n">P</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># /= est un raccourci pour P = P / P.sum(1, keepdims=True)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Matrice normalisÃ©e P est de taille : &quot;</span><span class="p">,</span><span class="n">P</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1"># On vÃ©rifie que la somme d&#39;une ligne est Ã©gale Ã  1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Somme de la premiÃ¨re ligne de P : &quot;</span><span class="p">,</span><span class="n">P</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Somme des lignes :  torch.Size([46, 1])
Matrice normalisÃ©e P est de taille :  torch.Size([46, 46])
Somme de la premiÃ¨re ligne de P :  1.0
</pre></div>
</div>
</div>
</div>
<p><strong>å…³äºä¸åŒå¤§å°çŸ©é˜µç›¸é™¤çš„è¯´æ˜</strong>ï¼šæ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œæˆ‘ä»¬å°†ä¸€ä¸ª 46Ã—46 çš„çŸ©é˜µé™¤ä»¥ä¸€ä¸ª 46Ã—1 çš„çŸ©é˜µï¼Œè¿™çœ‹èµ·æ¥ä¸å¯èƒ½ã€‚åœ¨ PyTorch ä¸­ï¼Œå­˜åœ¨<a class="reference external" href="https://pytorch.org/docs/stable/notes/broadcasting.html">å¹¿æ’­è§„åˆ™</a>ã€‚æˆ‘å¼ºçƒˆå»ºè®®æ‚¨ç†Ÿæ‚‰è¿™ä¸€æ¦‚å¿µï¼Œå› ä¸ºå®ƒæ˜¯å¸¸è§é”™è¯¯çš„æ¥æºã€‚è¦è¯¦ç»†äº†è§£å¹¿æ’­è§„åˆ™ï¼Œæ‚¨å¯ä»¥å‚è€ƒ<a class="reference internal" href="../Bonus_CoursSp%C3%A9cifiques/04_Broadcasting.html"><span class="std std-doc">å¥–åŠ±è¯¾ç¨‹</span></a>ã€‚
åœ¨å®è·µä¸­ï¼Œå°† 46Ã—46 çš„çŸ©é˜µé™¤ä»¥ 46Ã—1 çš„çŸ©é˜µæ—¶ï¼ŒPyTorch ä¼šå°† 46Ã—1 çš„çŸ©é˜µâ€œå¹¿æ’­â€ä¸º 46Ã—46 çš„çŸ©é˜µï¼Œé€šè¿‡å¤åˆ¶ 46 æ¬¡åŸºçŸ©é˜µæ¥å®ç°ã€‚è¿™æ ·å¯ä»¥æŒ‰é¢„æœŸæ‰§è¡Œè¿ç®—ã€‚</p>
</section>
<section id="id6">
<h3>ç”Ÿæˆ<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬ç»ˆäºå¯ä»¥ç”¨äºŒå…ƒæ¨¡å‹æ–¹æ³•ç”Ÿæˆåå­—äº†ï¼
æˆ‘ä»¬å°†å®šä¹‰ä¸€ä¸ªå‡½æ•°æ¥ç”Ÿæˆåå­—ï¼š</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">genName</span><span class="p">():</span>
  <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">ix</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># On commence par &#39;.&#39;</span>
  <span class="k">while</span> <span class="kc">True</span><span class="p">:</span> <span class="c1"># Tant qu&#39;on n&#39;a pas gÃ©nÃ©rÃ© le caractÃ¨re &#39;.&#39;</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="c1"># On rÃ©cupÃ¨re la distribution de probabilitÃ© de la ligne correspondant au caractÃ¨re actuel</span>
    <span class="n">ix</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">multinomial</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">replacement</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="c1"># On tire un Ã©chantillon</span>
    <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">itos</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span> <span class="c1"># On ajoute le caractÃ¨re Ã  notre prÃ©nom</span>
    <span class="k">if</span> <span class="n">ix</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="k">break</span>
  <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="n">genName</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;MARAUSUR.&#39;
</pre></div>
</div>
</div>
</div>
<p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ç”Ÿæˆ10ä¸ªéšæœºåå­—ï¼š</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">genName</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DA.
TYEYSE-SSCL.
DE.
ANINEDANDVI.
SOKE.
RENNA.
FUXA.
EROA.
FA.
KALEN.
</pre></div>
</div>
</div>
</div>
<p>å¯ä»¥çœ‹åˆ°ï¼Œç”Ÿæˆçš„åå­—è´¨é‡ä¸é«˜â€¦
ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºäºŒå…ƒæ¨¡å‹æ˜¯ä¸€ç§éå¸¸æœ‰é™çš„æ–¹æ³•ã€‚ä»…ä¾èµ–ä¸Šä¸€ä¸ªå­—ç¬¦æ— æ³•æä¾›è¶³å¤Ÿçš„ä¿¡æ¯æ¥ç”Ÿæˆæ­£ç¡®çš„åå­—ã€‚</p>
</section>
</section>
<section id="id7">
<h2>æ¨¡å‹è¯„ä¼°<a class="headerlink" href="#id7" title="Link to this heading">#</a></h2>
<section id="likelihood">
<h3>æœ€å¤§ä¼¼ç„¶ï¼ˆLikelihoodï¼‰<a class="headerlink" href="#likelihood" title="Link to this heading">#</a></h3>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬æƒ³è¦åœ¨è®­ç»ƒé›†ä¸Šè¯„ä¼°æˆ‘ä»¬çš„æ¨¡å‹ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨æœ€å¤§ä¼¼ç„¶æ³•ï¼Œç±»ä¼¼äº<a class="reference internal" href="../01_Fondations/02_R%C3%A9gressionLogistique.html"><span class="std std-doc">ç¬¬ä¸€è¯¾ç¬¬äºŒç¬”è®°æœ¬</span></a>ä¸­çš„æ–¹æ³•ã€‚
æœ€å¤§ä¼¼ç„¶ï¼ˆLikelihoodï¼‰æ˜¯ä¸€ä¸ªåº¦é‡å€¼ï¼Œå¯¹åº”äºäº‹ä»¶æ¦‚ç‡çš„ä¹˜ç§¯ã€‚ä¸ºäº†è·å¾—ä¸€ä¸ªå¥½çš„æ¨¡å‹ï¼Œæˆ‘ä»¬å¸Œæœ›æœ€å¤§åŒ–ä¼¼ç„¶å€¼ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">productOfProbs</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span><span class="p">[:</span><span class="mi">2</span><span class="p">]:</span>
  <span class="n">chs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span>
  <span class="k">for</span> <span class="n">ch1</span><span class="p">,</span> <span class="n">ch2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">chs</span><span class="p">,</span> <span class="n">chs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="n">ix1</span> <span class="o">=</span> <span class="n">stoi</span><span class="p">[</span><span class="n">ch1</span><span class="p">]</span>
    <span class="n">ix2</span> <span class="o">=</span> <span class="n">stoi</span><span class="p">[</span><span class="n">ch2</span><span class="p">]</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">ix1</span><span class="p">,</span> <span class="n">ix2</span><span class="p">]</span>
    <span class="n">productOfProbs</span> <span class="o">*=</span> <span class="n">prob</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;La probabilitÃ© de </span><span class="si">{</span><span class="n">ch1</span><span class="si">}</span><span class="s2">-&gt;</span><span class="si">{</span><span class="n">ch2</span><span class="si">}</span><span class="s2"> est </span><span class="si">{</span><span class="n">prob</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Le produit des probabilitÃ©s est : &quot;</span><span class="p">,</span><span class="n">productOfProbs</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>La probabilitÃ© de .-&gt;M est 0.120
La probabilitÃ© de M-&gt;A est 0.431
La probabilitÃ© de A-&gt;R est 0.084
La probabilitÃ© de R-&gt;I est 0.256
La probabilitÃ© de I-&gt;E est 0.119
La probabilitÃ© de E-&gt;. est 0.321
La probabilitÃ© de .-&gt;J est 0.045
La probabilitÃ© de J-&gt;E est 0.232
La probabilitÃ© de E-&gt;A est 0.024
La probabilitÃ© de A-&gt;N est 0.201
La probabilitÃ© de N-&gt;. est 0.212
Le produit des probabilitÃ©s est :  4.520583629652464e-10
</pre></div>
</div>
</div>
</div>
<p>æˆ‘ä»¬å¾ˆå¿«å‘ç°ï¼Œå°†æ¦‚ç‡ç›¸ä¹˜ä¼šå¸¦æ¥é—®é¢˜ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä»…å¯¹æ•°æ®é›†ä¸­30,000ä¸ªå…ƒç´ ä¸­çš„2ä¸ªè¿›è¡Œç›¸ä¹˜ï¼Œå°±å¾—åˆ°äº†ä¸€ä¸ªéå¸¸å°çš„å€¼ã€‚å¦‚æœå¯¹æ•´ä¸ªæ•°æ®é›†è¿›è¡Œç›¸ä¹˜ï¼Œç»“æœå°†è¶…å‡ºè®¡ç®—æœºçš„è¡¨ç¤ºèŒƒå›´ã€‚</p>
</section>
<section id="log-likelihood">
<h3>å¯¹æ•°ä¼¼ç„¶ï¼ˆLog-likelihoodï¼‰<a class="headerlink" href="#log-likelihood" title="Link to this heading">#</a></h3>
<p>ä¸ºäº†è§£å†³ç²¾åº¦é—®é¢˜ï¼Œæˆ‘ä»¬ä½¿ç”¨å¯¹æ•°ï¼ŒåŸå› å¦‚ä¸‹ï¼š</p>
<ul class="simple">
<li><p>å¯¹æ•°å‡½æ•°æ˜¯å•è°ƒçš„ï¼Œå³å¦‚æœ <span class="math notranslate nohighlight">\(a &gt; b\)</span>ï¼Œåˆ™ <span class="math notranslate nohighlight">\(log(a) &gt; log(b)\)</span>ã€‚åœ¨ä¼˜åŒ–èƒŒæ™¯ä¸‹ï¼Œæœ€å¤§åŒ–å¯¹æ•°ä¼¼ç„¶ç­‰ä»·äºæœ€å¤§åŒ–ä¼¼ç„¶ã€‚</p></li>
<li><p>å¯¹æ•°çš„ä¸€ä¸ªæœ‰ç”¨æ€§è´¨ï¼ˆè§£é‡Šäº†ä¸ºä»€ä¹ˆå®ƒåœ¨ä¼˜åŒ–å’Œæ¦‚ç‡ä¸­å¸¸ç”¨ï¼‰æ˜¯ï¼š<span class="math notranslate nohighlight">\(log(a \times b) = log(a) + log(b)\)</span>ã€‚è¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿé¿å…å°†å°æ•°ç›¸ä¹˜ï¼Œä»è€Œè¶…å‡ºè®¡ç®—æœºçš„ç²¾åº¦èŒƒå›´ã€‚</p></li>
</ul>
<p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æœ€å¤§åŒ–å¯¹æ•°ä¼¼ç„¶ï¼Œè€Œä¸æ˜¯ä¼¼ç„¶ã€‚æˆ‘ä»¬é‡æ–°è¿è¡Œä¹‹å‰çš„å¾ªç¯ï¼Œçœ‹çœ‹ç»“æœå¦‚ä½•ï¼š</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sumOfLogs</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span><span class="p">[:</span><span class="mi">2</span><span class="p">]:</span>
  <span class="n">chs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span>
  <span class="k">for</span> <span class="n">ch1</span><span class="p">,</span> <span class="n">ch2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">chs</span><span class="p">,</span> <span class="n">chs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="n">ix1</span> <span class="o">=</span> <span class="n">stoi</span><span class="p">[</span><span class="n">ch1</span><span class="p">]</span>
    <span class="n">ix2</span> <span class="o">=</span> <span class="n">stoi</span><span class="p">[</span><span class="n">ch2</span><span class="p">]</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">ix1</span><span class="p">,</span> <span class="n">ix2</span><span class="p">]</span>
    <span class="n">sumOfLogs</span> <span class="o">+=</span> <span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;La somme des log est : &quot;</span><span class="p">,</span><span class="n">sumOfLogs</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>La somme des log est :  -21.517210006713867
</pre></div>
</div>
</div>
</div>
<p>è¿™æ ·æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªæ›´åˆç†çš„å€¼ã€‚åœ¨ä¼˜åŒ–é—®é¢˜ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸æ›´å¸Œæœ›æœ‰ä¸€ä¸ªéœ€è¦æœ€å°åŒ–çš„å‡½æ•°ã€‚åœ¨å®Œç¾æ¨¡å‹çš„æƒ…å†µä¸‹ï¼Œæ¯ä¸ªæ¦‚ç‡å€¼ä¸º1ï¼Œå› æ­¤æ¯ä¸ªå¯¹æ•°å€¼ä¸º0ï¼Œå¯¹æ•°çš„æ€»å’Œä¹Ÿä¸º0ã€‚å¦åˆ™ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°è´Ÿå€¼ï¼Œå› ä¸ºæ¦‚ç‡æ€»æ˜¯å°äº1ï¼Œä¸” <span class="math notranslate nohighlight">\(log(a) &lt; 0 \text{ å¦‚æœ } a &lt; 1\)</span>ã€‚
ä¸ºäº†å¾—åˆ°ä¸€ä¸ªæœ€å°åŒ–é—®é¢˜ï¼Œæˆ‘ä»¬ä½¿ç”¨è´Ÿå¯¹æ•°ä¼¼ç„¶ï¼Œå®ƒä»…ä»…æ˜¯å¯¹æ•°ä¼¼ç„¶çš„ç›¸åæ•°ã€‚</p>
<p>é€šå¸¸ï¼Œæˆ‘ä»¬ä½¿ç”¨å¹³å‡å€¼è€Œä¸æ˜¯æ€»å’Œï¼Œå› ä¸ºå¹³å‡å€¼æ›´æ˜“è¯»ä¸”åœ¨ä¼˜åŒ–æ–¹é¢ä¸æ€»å’Œç­‰ä»·ã€‚æˆ‘ä»¬å°†åœ¨æ•´ä¸ªæ•°æ®é›†çš„åå­—ä¸Šè®¡ç®—å®ƒã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sumOfLogs</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">n</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
  <span class="n">chs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span>
  <span class="k">for</span> <span class="n">ch1</span><span class="p">,</span> <span class="n">ch2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">chs</span><span class="p">,</span> <span class="n">chs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="n">ix1</span> <span class="o">=</span> <span class="n">stoi</span><span class="p">[</span><span class="n">ch1</span><span class="p">]</span>
    <span class="n">ix2</span> <span class="o">=</span> <span class="n">stoi</span><span class="p">[</span><span class="n">ch2</span><span class="p">]</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">ix1</span><span class="p">,</span> <span class="n">ix2</span><span class="p">]</span>
    <span class="n">sumOfLogs</span> <span class="o">+=</span> <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>
    <span class="n">n</span><span class="o">+=</span><span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;La somme des negative log est : &quot;</span><span class="p">,</span><span class="n">sumOfLogs</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;La moyenne des negative log est : &quot;</span><span class="p">,</span><span class="n">sumOfLogs</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>La somme des negative log est :  564925.125
La moyenne des negative log est :  2.4960792002651053
</pre></div>
</div>
</div>
</div>
<p>æ•°æ®é›†çš„è´Ÿå¯¹æ•°ä¼¼ç„¶å€¼ä¸º2.49ã€‚</p>
<p>æ‚¨è¿˜å¯ä»¥æŸ¥çœ‹è‡ªå·±çš„åå­—ç›¸å¯¹äºæ•°æ®é›†çš„å¹³å‡å€¼æ˜¯å¦å¸¸è§ã€‚åªéœ€å°†æˆ‘çš„åå­—â€œSIMONâ€æ›¿æ¢ä¸ºæ‚¨çš„åå­—ï¼ˆå¤§å†™ï¼‰å³å¯ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sumOfLogs</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">n</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="s2">&quot;SIMON&quot;</span><span class="p">:</span>
  <span class="n">chs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span>
  <span class="k">for</span> <span class="n">ch1</span><span class="p">,</span> <span class="n">ch2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">chs</span><span class="p">,</span> <span class="n">chs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="n">ix1</span> <span class="o">=</span> <span class="n">stoi</span><span class="p">[</span><span class="n">ch1</span><span class="p">]</span>
    <span class="n">ix2</span> <span class="o">=</span> <span class="n">stoi</span><span class="p">[</span><span class="n">ch2</span><span class="p">]</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">ix1</span><span class="p">,</span> <span class="n">ix2</span><span class="p">]</span>
    <span class="n">sumOfLogs</span> <span class="o">+=</span> <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>
    <span class="n">n</span><span class="o">+=</span><span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;La moyenne des negative log est : &quot;</span><span class="p">,</span><span class="n">sumOfLogs</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>La moyenne des negative log est :  2.598056602478027
</pre></div>
</div>
</div>
</div>
<p>å¦‚æœæ‚¨çš„åå­—å¯¹åº”çš„è´Ÿå¯¹æ•°ä¼¼ç„¶å€¼å°äºæ•°æ®é›†çš„å€¼ï¼Œé‚£ä¹ˆæ‚¨çš„åå­—æ¯”è¾ƒå¸¸è§ã€‚å¦åˆ™ï¼Œå®ƒå¯èƒ½ä¸å¤ªå¸¸è§ã€‚</p>
</section>
</section>
<section id="id8">
<h2>ç¥ç»ç½‘ç»œæ–¹æ³•<a class="headerlink" href="#id8" title="Link to this heading">#</a></h2>
<section id="id9">
<h3>è®¡æ•°æ–¹æ³•çš„é—®é¢˜<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬å°†å°è¯•ç”¨ä¸åŒçš„æ–¹æ³•è§£å†³åŒä¸€ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬ä¹‹å‰é€šè¿‡ç®€å•è®¡æ•°äºŒå…ƒæ¨¡å‹çš„å‡ºç°æ¬¡æ•°å¹¶è®¡ç®—æ¦‚ç‡æ¥è§£å†³é—®é¢˜ã€‚è¿™ç§æ–¹æ³•é€‚ç”¨äºäºŒå…ƒæ¨¡å‹ï¼Œä½†å¯¹äºæ›´å¤æ‚çš„ N-gram åˆ™ä¸é€‚ç”¨ã€‚</p>
<p>å®é™…ä¸Šï¼Œæˆ‘ä»¬çš„æŸ¥æ‰¾è¡¨å¯¹äºä¸¤ä¸ªå­—ç¬¦æ¥è¯´æ˜¯ 46Ã—46 å¤§å°ã€‚å¦‚æœè€ƒè™‘ N ä¸ªå­—ç¬¦ï¼ˆå³ç”¨ N-1 ä¸ªå­—ç¬¦é¢„æµ‹ç¬¬ N ä¸ªå­—ç¬¦ï¼‰ï¼Œé‚£ä¹ˆå¯èƒ½æ€§ä¼šå¤§å¤§å¢åŠ ã€‚å¯ä»¥ç®€å•è®¡ç®—ï¼Œè¯¥è¡¨çš„å¤§å°ä¸º <span class="math notranslate nohighlight">\(46^N\)</span>ã€‚å¯¹äº N=4ï¼Œè¿™å°†äº§ç”Ÿä¸€ä¸ªå¤§å°ä¸º 4,477,456 çš„è¡¨ã€‚å¯¹äºå¤§å‹ä¸Šä¸‹æ–‡ï¼ˆå¦‚ä»Šçš„æ¨¡å‹æœ‰æ•°ä¸‡ä¸ª token çš„ä¸Šä¸‹æ–‡ï¼Œä¸”æ¯æ¬¡æœ‰è¶…è¿‡46ç§å¯èƒ½æ€§ï¼‰ï¼Œè¿™ç§æ–¹æ³•å®Œå…¨è¡Œä¸é€šã€‚</p>
<p>å› æ­¤ï¼Œç¥ç»ç½‘ç»œæ–¹æ³•éå¸¸æœ‰å¸å¼•åŠ›ã€‚åœ¨æ¥ä¸‹æ¥çš„è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†å±•ç¤ºå¦‚ä½•ç”¨ç¥ç»ç½‘ç»œè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¿™å°†å¸®åŠ©æ‚¨ç†è§£éšç€ä¸Šä¸‹æ–‡å¢åŠ ï¼Œç½‘ç»œçš„èƒ½åŠ›ã€‚</p>
</section>
<section id="id10">
<h3>ç¥ç»ç½‘ç»œçš„æ•°æ®é›†<a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<p>æˆ‘ä»¬çš„ç¥ç»ç½‘ç»œå°†æ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä½œä¸ºè¾“å…¥ï¼Œå¹¶é¢„æµ‹ä¸‹ä¸€ä¸ªå­—ç¬¦ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è´Ÿå¯¹æ•°ä¼¼ç„¶å‡½æ•°ä½œä¸ºæŸå¤±å‡½æ•°ï¼Œä»¥å°½å¯èƒ½æ¥è¿‘è®¡æ•°æ–¹æ³•å¾—åˆ°çš„äºŒå…ƒæ¨¡å‹å€¼ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºè®­ç»ƒæ•°æ®é›†ã€‚æˆ‘ä»¬é‡ç”¨ä¹‹å‰éå†äºŒå…ƒæ¨¡å‹çš„å¾ªç¯ï¼Œè¿™æ¬¡æˆ‘ä»¬ç´¢å¼•ä¸¤ä¸ªåˆ—è¡¨ï¼š<code class="docutils literal notranslate"><span class="pre">xs</span></code> ç”¨äºè¾“å…¥ï¼Œ<code class="docutils literal notranslate"><span class="pre">ys</span></code> ç”¨äºæ ‡ç­¾ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create the training set of bigrams (x,y)</span>
<span class="n">xs</span><span class="p">,</span> <span class="n">ys</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span><span class="p">[:</span><span class="mi">1</span><span class="p">]:</span>
  <span class="n">chs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span>
  <span class="k">for</span> <span class="n">ch1</span><span class="p">,</span> <span class="n">ch2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">chs</span><span class="p">,</span> <span class="n">chs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="n">ix1</span> <span class="o">=</span> <span class="n">stoi</span><span class="p">[</span><span class="n">ch1</span><span class="p">]</span>
    <span class="n">ix2</span> <span class="o">=</span> <span class="n">stoi</span><span class="p">[</span><span class="n">ch2</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ch1</span><span class="p">,</span> <span class="n">ch2</span><span class="p">)</span>
    <span class="n">xs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ix1</span><span class="p">)</span>
    <span class="n">ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ix2</span><span class="p">)</span>
    
<span class="n">xs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
<span class="n">ys</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>. M
M A
A R
R I
I E
E .
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;valeurs d&#39;entrÃ©e : &quot;</span><span class="p">,</span><span class="n">xs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;valeurs de sortie : &quot;</span><span class="p">,</span><span class="n">ys</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>valeurs d&#39;entrÃ©e :  tensor([ 0, 15,  3, 20, 11,  7])
valeurs de sortie :  tensor([15,  3, 20, 11,  7,  0])
</pre></div>
</div>
</div>
</div>
<p>å¯¹äºè¾“å…¥å€¼0ï¼ˆå¯¹åº”â€œ.â€ï¼‰ï¼Œæˆ‘ä»¬æƒ³è¦é¢„æµ‹æ ‡ç­¾15ï¼ˆå¯¹åº”â€œMâ€ï¼‰ã€‚</p>
<p>è¿™äº›åˆ—è¡¨çš„é—®é¢˜æ˜¯å®ƒä»¬åŒ…å«æ•´æ•°ï¼Œè€Œç¥ç»ç½‘ç»œçš„è¾“å…¥ä¸èƒ½æ˜¯æ•´æ•°ã€‚åœ¨è‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨<strong>ç‹¬çƒ­ç¼–ç ï¼ˆone-hot encodingï¼‰</strong>ï¼Œå®ƒå°†ä¸€ä¸ªç´¢å¼•è½¬æ¢ä¸ºä¸€ä¸ªå…¨é›¶å‘é‡ï¼Œä»…åœ¨ç´¢å¼•ä½ç½®ä¸Šä¸º1ã€‚å‘é‡çš„å¤§å°å¯¹åº”äºå¯èƒ½çš„ç±»åˆ«æ•°é‡ï¼Œè¿™é‡Œæ˜¯46ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="c1"># one-hot encoding</span>
<span class="n">xenc</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">one_hot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">46</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span> <span class="c1"># conversion en float pour le NN</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Encodage one-hot des deux premiers caractÃ¨res: &quot;</span><span class="p">,</span><span class="n">xenc</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Encodage one-hot des deux premiers caractÃ¨res:  tensor([[1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,
         0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]])
</pre></div>
</div>
</div>
</div>
<p>å¯ä»¥çœ‹åˆ°ï¼Œç¬¬ä¸€ä¸ªå‘é‡çš„ç¬¬0ä½æ˜¯1ï¼Œç¬¬äºŒä¸ªå‘é‡çš„ç¬¬15ä½æ˜¯1ã€‚è¿™äº›å‘é‡å°†ä½œä¸ºæˆ‘ä»¬ç¥ç»ç½‘ç»œçš„è¾“å…¥ã€‚æˆ‘ä»¬å¯ä»¥å¯è§†åŒ–è¿™äº›å‘é‡ï¼Œä»¥æ›´å¥½åœ°ç†è§£ç‹¬çƒ­ç¼–ç çš„ä½œç”¨ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Les 5 premiers vecteurs one-hot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">xenc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x784579d81f10&gt;
</pre></div>
</div>
<img alt="../_images/ff5371c82572c1f90d9fa93adee2bc0e1c73e24631447002e6deaa6c08c003db.png" src="../_images/ff5371c82572c1f90d9fa93adee2bc0e1c73e24631447002e6deaa6c08c003db.png" />
</div>
</div>
</section>
<section id="id11">
<h3>æˆ‘ä»¬çš„ç¥ç»ç½‘ç»œ<a class="headerlink" href="#id11" title="Link to this heading">#</a></h3>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬å°†åˆ›å»ºæˆ‘ä»¬çš„ç¥ç»ç½‘ç»œã€‚å®ƒå°†æ˜¯ä¸€ä¸ªæå…¶ç®€å•çš„ç¥ç»ç½‘ç»œï¼ŒåªåŒ…å«ä¸€å±‚ã€‚å¯¹äºå±‚çš„å¤§å°ï¼Œæˆ‘ä»¬è¾“å…¥ä¸€ä¸ªå¤§å°ä¸º <span class="math notranslate nohighlight">\(n \times 46\)</span> çš„å‘é‡ï¼Œå› æ­¤ç¬¬ä¸€ä¸ªç»´åº¦çš„å¤§å°ä¸º46ã€‚åœ¨è¾“å‡ºç«¯ï¼Œæˆ‘ä»¬å¸Œæœ›å¾—åˆ°æ‰€æœ‰å­—ç¬¦çš„æ¦‚ç‡åˆ†å¸ƒã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„ç½‘ç»œå±‚å¤§å°ä¸º <span class="math notranslate nohighlight">\(46 \times 46\)</span>ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬ç”¨éšæœºå€¼åˆå§‹åŒ–æˆ‘ä»¬çš„å±‚ï¼š</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># On met le paramÃ¨tre requires_grad Ã  True pour pouvoir optimiser la matrice par descente de gradient</span>
<span class="n">W</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="mi">46</span><span class="p">,</span> <span class="mi">46</span><span class="p">),</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<p>æˆ‘ä»¬ç¥ç»ç½‘ç»œçš„å‰å‘ä¼ æ’­ä»…åŒ…æ‹¬è¾“å…¥ä¸å±‚ä¹‹é—´çš„çŸ©é˜µä¹˜æ³•ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†åº”ç”¨ <em>softmax</em> å‡½æ•°ï¼ˆè§ CNN è¯¾ç¨‹ï¼‰ä»¥è·å¾—æ¦‚ç‡åˆ†å¸ƒã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># One hot encoding sur les entrÃ©es</span>
<span class="n">xenc</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">one_hot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">46</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span> 
<span class="c1"># Multiplication matricielle (forward pass)</span>
<span class="n">logits</span> <span class="o">=</span> <span class="n">xenc</span> <span class="o">@</span> <span class="n">W</span>  <span class="c1"># @ est la multiplication matricielle</span>
<span class="c1">#Softmax pour obtenir des probabilitÃ©s</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">logits</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span> 
<span class="n">probs</span> <span class="o">=</span> <span class="n">counts</span> <span class="o">/</span> <span class="n">counts</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="n">probs</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>torch.Size([6, 46])
</pre></div>
</div>
</div>
</div>
<p>æˆ‘ä»¬å¾—åˆ°äº†6ä¸ªå­—ç¬¦çš„æ¦‚ç‡åˆ†å¸ƒã€‚æˆ‘ä»¬å°†å¯è§†åŒ–æœªç»è®­ç»ƒçš„ç¥ç»ç½‘ç»œçš„è¾“å‡ºï¼Œå¹¶è®¡ç®—è´Ÿå¯¹æ•°ä¼¼ç„¶ï¼Œä»¥äº†è§£æˆ‘ä»¬ä¸è®¡æ•°æ–¹æ³•å¾—åˆ°çš„æ¨¡å‹ä¹‹é—´çš„å·®è·ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nlls</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
  <span class="n">x</span> <span class="o">=</span> <span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="c1"># index de l&#39;entrÃ©e</span>
  <span class="n">y</span> <span class="o">=</span> <span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="c1"># index du label</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------&#39;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;bigramme actuel </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">itos</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="si">}{</span><span class="n">itos</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="si">}</span><span class="s1"> (indexes </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;entrÃ©e du rÃ©seau de neurones :&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;sortie du rÃ©seau (probabilitÃ©) :&#39;</span><span class="p">,</span> <span class="n">probs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;vrai label :&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
  <span class="n">p</span> <span class="o">=</span> <span class="n">probs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;probabilitÃ© donnÃ© par le rÃ©seau sur le caractÃ¨re rÃ©el :&#39;</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
  <span class="n">logp</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
  <span class="n">nll</span> <span class="o">=</span> <span class="o">-</span><span class="n">logp</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;negative log likelihood:&#39;</span><span class="p">,</span> <span class="n">nll</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
  <span class="n">nlls</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">nll</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;=========&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;negative log likelihood moyen, i.e. loss =&#39;</span><span class="p">,</span> <span class="n">nlls</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--------
bigramme actuel 1: .M (indexes 0,15)
entrÃ©e du rÃ©seau de neurones : 0
sortie du rÃ©seau (probabilitÃ©) : tensor([0.0146, 0.0210, 0.0823, 0.0077, 0.0160, 0.0483, 0.0943, 0.0204, 0.0079,
        0.0112, 0.0085, 0.0179, 0.0188, 0.0292, 0.0022, 0.0092, 0.0200, 0.0094,
        0.0097, 0.0191, 0.1091, 0.0122, 0.0092, 0.0287, 0.0120, 0.0088, 0.0053,
        0.0217, 0.0177, 0.0050, 0.0038, 0.0483, 0.0320, 0.0441, 0.0105, 0.0126,
        0.0266, 0.0092, 0.0262, 0.0081, 0.0430, 0.0012, 0.0102, 0.0025, 0.0126,
        0.0116], grad_fn=&lt;SelectBackward0&gt;)
vrai label : 15
probabilitÃ© donnÃ© par le rÃ©seau sur le caractÃ¨re rÃ©el : 0.009214116260409355
negative log likelihood: 4.687018394470215
--------
bigramme actuel 2: MA (indexes 15,3)
entrÃ©e du rÃ©seau de neurones : 15
sortie du rÃ©seau (probabilitÃ©) : tensor([0.0574, 0.1353, 0.0227, 0.0032, 0.1142, 0.0148, 0.1007, 0.0162, 0.0242,
        0.0089, 0.0040, 0.0459, 0.0023, 0.0081, 0.0064, 0.0124, 0.0083, 0.0112,
        0.0172, 0.0062, 0.0033, 0.0045, 0.0131, 0.0144, 0.0218, 0.0080, 0.0225,
        0.0097, 0.0164, 0.0074, 0.0165, 0.0091, 0.0412, 0.0087, 0.0100, 0.0039,
        0.0080, 0.0036, 0.0377, 0.0150, 0.0345, 0.0048, 0.0253, 0.0036, 0.0164,
        0.0210], grad_fn=&lt;SelectBackward0&gt;)
vrai label : 3
probabilitÃ© donnÃ© par le rÃ©seau sur le caractÃ¨re rÃ©el : 0.0031920599285513163
negative log likelihood: 5.74708890914917
--------
bigramme actuel 3: AR (indexes 3,20)
entrÃ©e du rÃ©seau de neurones : 3
sortie du rÃ©seau (probabilitÃ©) : tensor([0.0199, 0.0169, 0.0239, 0.0122, 0.0174, 0.0203, 0.0043, 0.0822, 0.0517,
        0.0228, 0.0118, 0.0121, 0.0210, 0.0088, 0.0063, 0.0128, 0.1041, 0.0100,
        0.0338, 0.0772, 0.0056, 0.0565, 0.0134, 0.0032, 0.0253, 0.0120, 0.0337,
        0.0080, 0.0083, 0.0060, 0.0068, 0.0020, 0.0405, 0.0120, 0.0366, 0.0080,
        0.0111, 0.0135, 0.0164, 0.0038, 0.0133, 0.0029, 0.0094, 0.0047, 0.0504,
        0.0271], grad_fn=&lt;SelectBackward0&gt;)
vrai label : 20
probabilitÃ© donnÃ© par le rÃ©seau sur le caractÃ¨re rÃ©el : 0.005596297327429056
negative log likelihood: 5.185649871826172
--------
bigramme actuel 4: RI (indexes 20,11)
entrÃ©e du rÃ©seau de neurones : 20
sortie du rÃ©seau (probabilitÃ©) : tensor([0.0030, 0.0300, 0.0056, 0.0311, 0.0361, 0.0294, 0.0462, 0.0163, 0.0369,
        0.0178, 0.0251, 0.0125, 0.0162, 0.0019, 0.0828, 0.0173, 0.0068, 0.0113,
        0.0204, 0.0124, 0.0653, 0.0059, 0.0038, 0.0075, 0.0165, 0.0332, 0.0065,
        0.0354, 0.0169, 0.0062, 0.0683, 0.0203, 0.0189, 0.0179, 0.0113, 0.0119,
        0.0549, 0.0035, 0.0051, 0.0061, 0.0569, 0.0268, 0.0164, 0.0021, 0.0146,
        0.0088], grad_fn=&lt;SelectBackward0&gt;)
vrai label : 11
probabilitÃ© donnÃ© par le rÃ©seau sur le caractÃ¨re rÃ©el : 0.012452212162315845
negative log likelihood: 4.385857105255127
--------
bigramme actuel 5: IE (indexes 11,7)
entrÃ©e du rÃ©seau de neurones : 11
sortie du rÃ©seau (probabilitÃ©) : tensor([0.0265, 0.0211, 0.0312, 0.0235, 0.0020, 0.0151, 0.0145, 0.0083, 0.0141,
        0.0062, 0.0168, 0.0183, 0.0600, 0.0047, 0.0969, 0.0438, 0.0083, 0.0584,
        0.0572, 0.0061, 0.0159, 0.0475, 0.0079, 0.0116, 0.0331, 0.0043, 0.0049,
        0.0134, 0.0057, 0.0077, 0.0350, 0.0276, 0.0174, 0.0050, 0.0176, 0.0022,
        0.0169, 0.0029, 0.0281, 0.0115, 0.0291, 0.0250, 0.0071, 0.0126, 0.0277,
        0.0491], grad_fn=&lt;SelectBackward0&gt;)
vrai label : 7
probabilitÃ© donnÃ© par le rÃ©seau sur le caractÃ¨re rÃ©el : 0.008320074528455734
negative log likelihood: 4.789083957672119
--------
bigramme actuel 6: E. (indexes 7,0)
entrÃ©e du rÃ©seau de neurones : 7
sortie du rÃ©seau (probabilitÃ©) : tensor([0.0397, 0.0266, 0.0185, 0.0024, 0.0054, 0.0061, 0.0143, 0.0269, 0.0398,
        0.0084, 0.0134, 0.0247, 0.1220, 0.0039, 0.0062, 0.0829, 0.0452, 0.0086,
        0.0062, 0.0130, 0.0106, 0.0137, 0.0073, 0.1132, 0.0146, 0.0252, 0.0112,
        0.0955, 0.0133, 0.0196, 0.0091, 0.0122, 0.0160, 0.0092, 0.0128, 0.0337,
        0.0058, 0.0112, 0.0070, 0.0029, 0.0033, 0.0073, 0.0052, 0.0049, 0.0125,
        0.0087], grad_fn=&lt;SelectBackward0&gt;)
vrai label : 0
probabilitÃ© donnÃ© par le rÃ©seau sur le caractÃ¨re rÃ©el : 0.0397193469107151
negative log likelihood: 3.225916862487793
=========
negative log likelihood moyen, i.e. loss = 4.670102596282959
</pre></div>
</div>
</div>
</div>
<p>åœ¨è®¡ç®—æŸå¤±æ—¶ï¼Œæˆ‘ä»¬å°†æŒ‰å¦‚ä¸‹æ–¹å¼è®¡ç®—ç½‘ç»œè¾“å‡ºç›¸å¯¹äºæ ‡ç­¾çš„è´Ÿå¯¹æ•°ä¼¼ç„¶ï¼š</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calcul de la loss</span>
<span class="n">loss</span> <span class="o">=</span> <span class="o">-</span><span class="n">probs</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">ys</span><span class="p">]</span><span class="o">.</span><span class="n">log</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
<span class="c1"># On remet les gradients Ã  zÃ©ro (None est plus efficace)</span>
<span class="n">W</span><span class="o">.</span><span class="n">grad</span> <span class="o">=</span> <span class="kc">None</span> 
<span class="c1"># Calcul des gradients automatique de pytorch</span>
<span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">W</span><span class="o">.</span><span class="n">grad</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.670102596282959
tensor([[0.0024, 0.0035, 0.0137,  ..., 0.0004, 0.0021, 0.0019],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        ...,
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]])
</pre></div>
</div>
</div>
</div>
<p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬è®¡ç®—äº†çŸ©é˜µ W ç›¸å¯¹äºæŸå¤±çš„æ¢¯åº¦ã€‚ä¸ä¹‹å‰çš„è¯¾ç¨‹ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªæ­¥é•¿ï¼ˆå­¦ä¹ ç‡ <em>learning_rate</em>ï¼‰æ²¿æ¢¯åº¦æ–¹å‘æ›´æ–°æ¨¡å‹çš„æƒé‡ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># avec un learning_rate de 0.1</span>
<span class="n">W</span><span class="o">.</span><span class="n">data</span> <span class="o">+=</span> <span class="o">-</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">W</span><span class="o">.</span><span class="n">grad</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id12">
<h3>ä¼˜åŒ–<a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<p>åŸºäºä¹‹å‰çš„æ‰€æœ‰å†…å®¹ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥å°†å„éƒ¨åˆ†ç»„åˆèµ·æ¥å¹¶ä¼˜åŒ–æˆ‘ä»¬çš„æ¨¡å‹ã€‚</p>
<p><strong>åˆ›å»ºå®Œæ•´æ•°æ®é›†</strong>
é¦–å…ˆï¼Œæˆ‘ä»¬å°†é€šè¿‡é‡ç”¨ä¹‹å‰çš„å¾ªç¯ï¼ˆä½†éå†æ‰€æœ‰åå­—ï¼‰æ¥åˆ›å»ºå®Œæ•´çš„æ•°æ®é›†ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
  <span class="n">chs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">]</span>
  <span class="k">for</span> <span class="n">ch1</span><span class="p">,</span> <span class="n">ch2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">chs</span><span class="p">,</span> <span class="n">chs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="n">ix1</span> <span class="o">=</span> <span class="n">stoi</span><span class="p">[</span><span class="n">ch1</span><span class="p">]</span>
    <span class="n">ix2</span> <span class="o">=</span> <span class="n">stoi</span><span class="p">[</span><span class="n">ch2</span><span class="p">]</span>
    <span class="n">xs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ix1</span><span class="p">)</span>
    <span class="n">ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ix2</span><span class="p">)</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
<span class="n">ys</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>
<span class="n">num</span> <span class="o">=</span> <span class="n">xs</span><span class="o">.</span><span class="n">nelement</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;number of examples: &#39;</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>number of examples:  226325
</pre></div>
</div>
</div>
</div>
<p><strong>åˆå§‹åŒ–æ¨¡å‹</strong>
ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥åƒä¹‹å‰ä¸€æ ·åˆå§‹åŒ–æ¨¡å‹ï¼Œå¹¶é€‰æ‹©å­¦ä¹ ç‡ <em>learning_rate</em> å’Œè¿­ä»£æ¬¡æ•°ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">W</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="mi">46</span><span class="p">,</span> <span class="mi">46</span><span class="p">),</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">lr</span><span class="o">=</span><span class="mi">50</span> <span class="c1"># en pratique, dans ce petit problÃ¨me, un learning rate de 50 fonctionne bien ce qui peut sembler Ã©tonnant</span>
<span class="n">iterations</span><span class="o">=</span><span class="mi">100</span>
</pre></div>
</div>
</div>
</div>
<p><strong>æ¢¯åº¦ä¸‹é™</strong>
ç°åœ¨ï¼Œæˆ‘ä»¬å°†åœ¨æ¨¡å‹ä¸Šåº”ç”¨æ¢¯åº¦ä¸‹é™ç®—æ³•ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Descente du gradient</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iterations</span><span class="p">):</span>
  
  <span class="c1"># forward pass</span>
  <span class="n">xenc</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">one_hot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">46</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span> <span class="c1"># transformation one hot sur les entrÃ©es</span>
  <span class="n">logits</span> <span class="o">=</span> <span class="n">xenc</span> <span class="o">@</span> <span class="n">W</span>
  <span class="n">probs</span><span class="o">=</span><span class="n">F</span><span class="o">.</span><span class="n">softmax</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># On applique le softmax</span>
  <span class="n">loss</span> <span class="o">=</span> <span class="o">-</span><span class="n">probs</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num</span><span class="p">),</span> <span class="n">ys</span><span class="p">]</span><span class="o">.</span><span class="n">log</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="c1"># Calcul du negative log likelihood (loss)</span>
  <span class="k">if</span> <span class="n">k</span><span class="o">%</span><span class="k">10</span>==0:
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;loss iteration &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; : &#39;</span><span class="p">,</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
  
  <span class="c1"># retropropagation</span>
  <span class="n">W</span><span class="o">.</span><span class="n">grad</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># Remettre la gradient Ã  zÃ©ro Ã  chaque itÃ©ration (Ã  ne pas oublier !!!!)</span>
  <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
  
  <span class="c1"># Mise Ã  jour des poids</span>
  <span class="n">W</span><span class="o">.</span><span class="n">data</span> <span class="o">+=</span> <span class="o">-</span><span class="mi">50</span> <span class="o">*</span> <span class="n">W</span><span class="o">.</span><span class="n">grad</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>loss iteration 0 :  4.346113204956055
loss iteration 10 :  2.94492769241333
loss iteration 20 :  2.7590363025665283
loss iteration 30 :  2.6798315048217773
loss iteration 40 :  2.637108087539673
loss iteration 50 :  2.610524892807007
loss iteration 60 :  2.5923469066619873
loss iteration 70 :  2.5791807174682617
loss iteration 80 :  2.569261074066162
loss iteration 90 :  2.561541795730591
</pre></div>
</div>
</div>
</div>
<p>ç»è¿‡100æ¬¡è¿­ä»£åï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªæ¥è¿‘è®¡æ•°æ–¹æ³•æ¨¡å‹çš„è´Ÿå¯¹æ•°ä¼¼ç„¶å€¼ã€‚è¿™å®é™…ä¸Šæ˜¯äºŒå…ƒæ¨¡å‹åœ¨è®­ç»ƒæ•°æ®ä¸Šçš„æœ€å¤§èƒ½åŠ›ã€‚</p>
<p><strong>ç”¨æˆ‘ä»¬çš„æ¨¡å‹ç”Ÿæˆåå­—</strong>
ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æˆ‘ä»¬çš„æ¨¡å‹ç”Ÿæˆåå­—äº†ã€‚</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
  
  <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">ix</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">xenc</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">one_hot</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">ix</span><span class="p">]),</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">46</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
    <span class="n">logits</span> <span class="o">=</span> <span class="n">xenc</span> <span class="o">@</span> <span class="n">W</span> 
    <span class="c1"># PrÃ©diction des probabilitÃ©s de la lettre suivante</span>
    <span class="n">p</span><span class="o">=</span><span class="n">F</span><span class="o">.</span><span class="n">softmax</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="c1"># On fait un tirage alÃ©atoire de la prochaine lettre en suivante la distribution p </span>
    <span class="n">ix</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">multinomial</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">replacement</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="c1"># Conversion en lettre</span>
    <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">itos</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">ix</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="k">break</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>JE.
S.
ADJULA.
M.
LVERTYÃœCI.
</pre></div>
</div>
</div>
</div>
</section>
<section id="id13">
<h3>è¡¥å……è¯´æ˜<a class="headerlink" href="#id13" title="Link to this heading">#</a></h3>
<p>æƒé‡çŸ©é˜µ <span class="math notranslate nohighlight">\(W\)</span> çš„å¤§å°ä¸è®¡æ•°æ–¹æ³•ä¸­ä½¿ç”¨çš„çŸ©é˜µ <span class="math notranslate nohighlight">\(N\)</span> ç›¸åŒã€‚æˆ‘ä»¬é€šè¿‡ç¥ç»ç½‘ç»œæ–¹æ³•æ‰€å®ç°çš„ï¼Œå®é™…ä¸Šæ˜¯å­¦ä¹ çŸ©é˜µ <span class="math notranslate nohighlight">\(N\)</span>ã€‚
æˆ‘ä»¬å¯ä»¥é€šè¿‡è§‚å¯Ÿ <code class="docutils literal notranslate"><span class="pre">xenc</span> <span class="pre">&#64;</span> <span class="pre">W</span></code> æ“ä½œæ¥éªŒè¯è¿™ä¸€ç›´è§‰ã€‚è¿™æ˜¯ä¸€ä¸ª <span class="math notranslate nohighlight">\(1 \times 46\)</span> çš„è¡ŒçŸ©é˜µä¸ä¸€ä¸ª <span class="math notranslate nohighlight">\(46 \times 46\)</span> çš„æ–¹é˜µçš„çŸ©é˜µä¹˜æ³•ã€‚æ­¤å¤–ï¼Œè¡ŒçŸ©é˜µä¸­é™¤äº†å­—æ¯ç´¢å¼• <span class="math notranslate nohighlight">\(i\)</span> å¤„ä¸º1å¤–ï¼Œå…¶ä½™å‡ä¸ºé›¶ã€‚è¯¥çŸ©é˜µä¹˜æ³•çš„ç»“æœæ˜¯çŸ©é˜µ <span class="math notranslate nohighlight">\(W\)</span> çš„ç¬¬ <span class="math notranslate nohighlight">\(i\)</span> è¡Œã€‚
è¿™ä¸æˆ‘ä»¬åœ¨è®¡æ•°æ–¹æ³•ä¸­æ‰€åšçš„å®Œå…¨ä¸€è‡´ï¼Œå³ä»çŸ©é˜µ <span class="math notranslate nohighlight">\(P\)</span> çš„ç¬¬ <span class="math notranslate nohighlight">\(i\)</span> è¡Œä¸­è·å–æ¦‚ç‡å€¼ã€‚</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./05_NLP"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="01_Introduction.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰ç®€ä»‹</p>
      </div>
    </a>
    <a class="right-next"
       href="03_R%C3%A9seauFullyConnected.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">å…¨è¿æ¥ç¥ç»ç½‘ç»œ</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">æ•°æ®é›†åˆ†æ</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">ä»€ä¹ˆæ˜¯äºŒå…ƒæ¨¡å‹ï¼Ÿ</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">è®¡æ•°æ–¹æ³•</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">å‡ºç°é¢‘æ¬¡çŸ©é˜µ</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">æ¦‚ç‡</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">ç”Ÿæˆ</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">æ¨¡å‹è¯„ä¼°</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#likelihood">æœ€å¤§ä¼¼ç„¶ï¼ˆLikelihoodï¼‰</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#log-likelihood">å¯¹æ•°ä¼¼ç„¶ï¼ˆLog-likelihoodï¼‰</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">ç¥ç»ç½‘ç»œæ–¹æ³•</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">è®¡æ•°æ–¹æ³•çš„é—®é¢˜</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">ç¥ç»ç½‘ç»œçš„æ•°æ®é›†</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">æˆ‘ä»¬çš„ç¥ç»ç½‘ç»œ</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">ä¼˜åŒ–</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">è¡¥å……è¯´æ˜</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Simon Thomine
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <div id="language-switcher" style="text-align: center; margin-top: 20px; padding: 10px; border-top: 1px solid #eee;">
  <span style="margin-right: 10px;">ğŸŒ Language / Langue:</span>
  <a href="#" onclick="switchToEnglish()" style="text-decoration: none; margin: 0 5px; padding: 5px 10px; background: #4CAF50; color: white; border-radius: 5px; font-weight: bold; transition: all 0.3s;">ğŸ‡ºğŸ‡¸ English</a>
  <a href="#" onclick="switchToFrench()" style="text-decoration: none; margin: 0 5px; padding: 5px 10px; background: #f0f0f0; border-radius: 5px; transition: all 0.3s;">ğŸ‡«ğŸ‡· FranÃ§ais</a>
  <a href="#" onclick="switchToSpanish()" style="text-decoration: none; margin: 0 5px; padding: 5px 10px; background: #ffd700; border-radius: 5px; transition: all 0.3s;">ğŸ‡ªğŸ‡¸ EspaÃ±ol</a>
  <a href="#" onclick="switchToChinese()" style="text-decoration: none; margin: 0 5px; padding: 5px 10px; background: #ff4b4b; color: white; border-radius: 5px; transition: all 0.3s;">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</a>
</div>
<script>
function getBaseUrl() {
  let baseUrl = window.location.origin;
  let pathname = window.location.pathname;
  if (pathname.includes('fr/')) {
    baseUrl += pathname.split('fr/')[0];
  } else if (pathname.includes('en/')) {
    baseUrl += pathname.split('en/')[0];
  } else if (pathname.includes('es/')) {
    baseUrl += pathname.split('es/')[0];
  } else if (pathname.includes('zh/')) {
    baseUrl += pathname.split('zh/')[0];
  } else {
    baseUrl += pathname.split('/').slice(0, -1).join('/') + '/';
  }
  return baseUrl;
}

function getCurrentPage() {
  let pathname = window.location.pathname;
  if (pathname.includes('fr/')) {
    return pathname.split('fr/')[1] || 'index.html';
  } else if (pathname.includes('en/')) {
    return pathname.split('en/')[1] || 'index.html';
  } else if (pathname.includes('es/')) {
    return pathname.split('es/')[1] || 'index.html';
  } else if (pathname.includes('zh/')) {
    return pathname.split('zh/')[1] || 'index.html';
  }
  return 'index.html';
}

function switchToEnglish() {
  const baseUrl = getBaseUrl();
  const currentPage = getCurrentPage();
  const newUrl = baseUrl + 'en/' + currentPage;
  window.location.href = newUrl;
}

function switchToFrench() {
  const baseUrl = getBaseUrl();
  const currentPage = getCurrentPage();
  const newUrl = baseUrl + 'fr/' + currentPage;
  window.location.href = newUrl;
}

function switchToSpanish() {
  const baseUrl = getBaseUrl();
  const currentPage = getCurrentPage();
  const newUrl = baseUrl + 'es/' + currentPage;
  window.location.href = newUrl;
}

function switchToChinese() {
  const baseUrl = getBaseUrl();
  const currentPage = getCurrentPage();
  const newUrl = baseUrl + 'zh/' + currentPage;
  window.location.href = newUrl;
}
</script>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>